---
title: "R-Bootcamp Report"
author: "Bernardo Freire Barboza da Cruz & Leonid Gavrilyuk"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    pdf_document:
        fig_caption: yes
        highlight: pygments
        keep_tex: yes
        number_sections: yes
        toc: yes
        fig_width: 16
        fig_height: 9
        df_print: kable
---

```{r setup, include = FALSE}
# Set echo, include, warning, message to FALSE
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	include = FALSE
)
# Import libraries
library(lattice)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
```

\pagebreak

# Introduction  
Describe the use case....

1. Most active districts				
2. Party dynamics 2006-2018				
3. Activity of genders (e.g. women are active voters)				
4. Activity of age groups				
5. Relationships between education and activity.				
6. Relationships between income and activity.				

\pagebreak

# Extract and Transform
## Data Import
The data is imported from _[Stadt ZÃ¼rich Open Data](https://data.stadt-zuerich.ch/)_. 
```{r import_data, echo = FALSE, cache=TRUE} 
# Set cache to true
VermoegenSteuerKreis <- read.csv(
    'https://data.stadt-zuerich.ch/dataset/fd_median_vermoegen_kreis_od1008/download/WIR100OD1008.csv'
)

EinkommenSteuerKreis <- read.csv(
    'https://data.stadt-zuerich.ch/dataset/fd_median_einkommen_kreis_od1007/download/WIR100OD1007.csv'
)

BildungKreisBildung <- read.csv(
    'https://data.stadt-zuerich.ch/dataset/bfs_bev_bildungsstand_statquartier_od1012/download/BIL101OD1012.csv'
)
```

### Exploration & Visualization: Wealth and Income data

#### Wealth Data  

```{r}
(head(VermoegenSteuerKreis))
(summary(VermoegenSteuerKreis))
```

```{r plot_wealth, include = TRUE}
ggplot(data = VermoegenSteuerKreis,
                         aes(x = SteuerJahr,
                             y = SteuerVermoegen_p50)) +
    geom_point(alpha = 0.4, aes(colour = KreisLang)) +
    theme_minimal() +
    facet_wrap(~ SteuerTarifLang) + #, scales = "free_y") +
    geom_smooth(alpha = 0.1, method = "lm", se = FALSE, 
                aes(colour = KreisLang)) +
    ggtitle("Wealth per year and kreis in city of Zurich") + 
    labs(y = "Median value") +
    theme(legend.position = "bottom",
        # axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(hjust = 0.5)) # +
    #scale_color_brewer("Kreis", type = "qual",  palette = "Set1")

```

#### Income  

```{r}
(head(EinkommenSteuerKreis))
(summary(EinkommenSteuerKreis))
```

```{r plot_income, include = TRUE}
ggplot(data = EinkommenSteuerKreis,
                         aes(x = SteuerJahr,
                             y = SteuerEinkommen_p50)) +
    geom_point(alpha = 0.4, aes(colour = KreisLang)) +
    theme_minimal() +
    facet_wrap(~ SteuerTarifLang) +
    geom_smooth(alpha = 0.1, method = "lm", se = FALSE, 
                aes(colour = KreisLang)) +
    ggtitle("Income per year and kreis in city of Zurich") + 
    labs(y = "Median value") +
    theme(legend.position = "bottom",
        # axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(hjust = 0.5)) # +
    #scale_color_brewer("Kreis", type = "qual",  palette = "Paired")
```

#### Combine Wealth and Income data  
The aim of this part is to combine the income and wealth data into one dataframe.  
```{r}
head(EinkommenSteuerKreis)
```

```{r}
head(VermoegenSteuerKreis)
```

```{r}
# Merge the two frames and drop redundant column KreisLang
EinkommenVermoegenSteuerKreis <- merge(
    EinkommenSteuerKreis, 
    VermoegenSteuerKreis)

# 
EinkommenVermoegenSteuerKreis <-EinkommenVermoegenSteuerKreis[,!(names(EinkommenVermoegenSteuerKreis) %in% c("KreisLang","SteuerTarifLang"))]

# Convert columns to factor
EinkommenVermoegenSteuerKreis[,2:3] <- sapply(EinkommenVermoegenSteuerKreis[,2:3], as.factor)
EinkommenVermoegenSteuerKreis
```

````{r}
EinkommenVermoegenSteuerKreis[EinkommenVermoegenSteuerKreis$KreisSort == c("1","2")]
```

### Exploration: Education  
#### Preproces Data   


## Data Exploration & Visualization  

```{r}
head(BildungKreisBildung)
```

## Merging Data  

## Data Visualization  

## Fit Model  

## Chapter of Choice TBD  

# References  


